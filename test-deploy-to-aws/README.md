# LICENSE

Read the file [LICENSE](./LICENSE) now.

# What is this folder and HOW-TO

IMPORTANT: See [sub-section on create-deploy-role](#step-4-run-bincreate-deploy-iamrolesh) below, for CRITICAL info for Enterprise-environments !!!

<HR/>

Qn: Why this subfolder?<BR/>
Ans: The `../test` folder does LOCAL testing based on `jest`, on the Cloudformation GENERATED (and eventually packaged into the `.whl` deployable for Python-CDK Construct)

If you customize anything in here -- to state the obvious -- we need to deploy the UPDATED CDK-Construct onto AWS, ..<BR/>
.. to verify nothing broke when we changed the code here.

That's what this sub-folder `test-deploy-to-aws` is all about.

# Step  - Pre-Requisite: In Parent folder

Attention: You must be in the PARENT folder (of this README) to run the following command.

```bash
npm run build
```

# Step 1: `cd ./test-deploy-to-aws`

# Step 2: Update `bin/common-settings.sh`

This is a must-do.

# Step 3: `.  ./bin/init.sh`

This will UTILIZE the updated CDK-Construct, and generate the `cdk.out` representing a deployable STACK.<BR>
This stack is very minimal:
1. Contains a dummy bucket
1. Contains the AWS-Resources createad by `ServerlessClamscan` Construct.
Nothing more.

# Step 4: Run `./bin/create-deploy-iamrole.sh`

This creates an IAM-role that is --used-- by the (following) `bin/deploy.sh` script, to deploy cloudformation.

There are 2 objectives of NOT relying on you utilizing your FULL-ADMIN privileges.

1. The obvious: Principle of Least Privilege.  Something you see all the time on AWS Documentation.
1. In enterprise-scenarios, people need to know what privileges are needed to:
    1.  to create this construct.
    1.  to update this construct.
    1.  to destroy this construct.

# Step 5: Run `./bin/deploy.sh`

# Clean Up: Run `./bin/clean.sh`

<HR/>
<HR/>
<HR/>
<HR/>

# Appendix: List of all AWS-Resources created.

Resources (58)


| Type | Status | Logical ID | Physical ID | Module |
| --- | --- | --- | --- | --- |
| AWS::CloudFormation::CustomResource | CREATE_COMPLETE | ClamAVServerlessClamscanInitDefsCrA77D3C14 | 2024/06/20/[$LATEST]b362ae4310a44d71898926da72fe93dd | - |
| AWS::CDK::Metadata | CREATE_COMPLETE | CDKMetadata | 7dd8acc0-2f17-11ef-b162-0a0040fb869b | - |
| AWS::Logs::LogGroup | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCFlowLogsLogGroup84A57AE0 | ClamAV-Malware-Scanner-CDKDeploy-ClamAVServerlessClamscanScanVPCFlowLogsLogGroup84A57AE0-Y5fODGxj4qWe | - |
| AWS::IAM::Policy | CREATE_COMPLETE | BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36 | ClamA-Bucke-TTwP3NNWu9IC | - |
| AWS::IAM::Policy | CREATE_COMPLETE | ClamAVServerlessClamscanDownloadDefsServiceRoleDefaultPolicy5DD0B9F9 | ClamA-ClamA-io8pL1RJFxOw | - |
| AWS::IAM::Policy | CREATE_COMPLETE | ClamAVServerlessClamscanInitDefsServiceRoleDefaultPolicy62A6DC7A | ClamA-ClamA-hSApfIMe8HCM | - |
| AWS::IAM::Policy | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCFlowLogsIAMRoleDefaultPolicyBA5185B5 | ClamA-ClamA-JMCGo7sbWg7K | - |
| AWS::IAM::Role | CREATE_COMPLETE | BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC | ClamAV-Malware-Scanner-CD-BucketNotificationsHandle-lM2azCgi19VQ | - |
| AWS::IAM::Role | CREATE_COMPLETE | ClamAVServerlessClamscanDownloadDefsServiceRole0F59D94E | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanD-GeSJBph9pOBv | - |
| AWS::IAM::Role | CREATE_COMPLETE | ClamAVServerlessClamscanInitDefsServiceRoleE42A15C0 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanI-fZ1zx4hZ4g19 | - |
| AWS::IAM::Role | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCFlowLogsIAMRole4BAB4610 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanS-XunnqGsc9Wrb | - |
| AWS::IAM::Role | CREATE_COMPLETE | CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092 | ClamAV-Malware-Scanner-CD-CustomS3AutoDeleteObjects-dQhQRDpLgTw4 | - |
| AWS::IAM::Role | CREATE_COMPLETE | CustomVpcRestrictDefaultSGCustomResourceProviderRole26592FE0 | ClamAV-Malware-Scanner-CD-CustomVpcRestrictDefaultS-Csx9U0YvBaav | - |
| AWS::EC2::VPC | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPC9CE28EB8 | vpc-05472204894c0ae44 | - |
| AWS::EC2::SecurityGroup | CREATE_COMPLETE | ClamAVServerlessClamscanScanFileSystemSecurityGroup3DA3B3A2 | sg-02d1ebf6483c54be1 | - |
| AWS::EC2::SecurityGroupIngress | CREATE_COMPLETE | ClamAVServerlessClamscanScanFileSystemSecurityGroupfromClamAVMalwareScannerCDKDeployClamAVServerlessClamscanSecurityGroup0F1352BF2049F1699B92 | sgr-0c1047edf72b36d02 | - |
| AWS::EC2::Subnet | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCIsolatedSubnet1Subnet9FD05416 | subnet-0730cbc87b1c44c77 | - |
| AWS::EC2::Subnet | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCIsolatedSubnet2Subnet822DC3C6 | subnet-0f5b6fa77cc70f680 | - |
| AWS::EC2::RouteTable | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCIsolatedSubnet1RouteTable3C1C7FA5 | rtb-0eae6a6ae24bc7de9 | - |
| AWS::EC2::RouteTable | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCIsolatedSubnet2RouteTableF435C2EA | rtb-08f749be68581f5c8 | - |
| AWS::EC2::SubnetRouteTableAssociation | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCIsolatedSubnet1RouteTableAssociationB6B57243 | rtbassoc-024a125b670e612e6 | - |
| AWS::EC2::SubnetRouteTableAssociation | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCIsolatedSubnet2RouteTableAssociation0428E08F | rtbassoc-06afe58fb4ee909c3 | - |
| AWS::EC2::FlowLog | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCFlowLogsFlowLogB7906787 | fl-03096b6bf32c33644 | - |
| Custom::VpcRestrictDefaultSG | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCRestrictDefaultSecurityGroupCustomResourceB29D6FDB | 1753cda2-8509-4dce-a018-2606f6348859 | - |
| AWS::EC2::VPCEndpoint | CREATE_COMPLETE | ClamAVServerlessClamscanScanVPCS3EndpointA0E53B9C | vpce-05960ab3b335d6990 | - |
| AWS::EC2::SecurityGroup | CREATE_COMPLETE | ClamAVServerlessClamscanSecurityGroup259C90BC | sg-0f20c6971b1007590 | - |
| AWS::EC2::SecurityGroupEgress | CREATE_COMPLETE | ClamAVServerlessClamscanSecurityGrouptoClamAVMalwareScannerCDKDeployClamAVServerlessClamscanScanFileSystemSecurityGroup30A7DB4C204966ED623F | sgr-02a45795200948e88 | - |
| AWS::IAM::Role | CREATE_COMPLETE | ClamAVServerlessClamscanServiceRole34192B65 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanS-COU7y2J6EC6m | - |
| AWS::IAM::Policy | CREATE_COMPLETE | ClamAVServerlessClamscanServiceRoleDefaultPolicy3F1F37F2 | ClamA-ClamA-GYaFXWdqaOjQ | - |
| AWS::EFS::FileSystem | CREATE_COMPLETE | ClamAVServerlessClamscanScanFileSystem52F92282 | fs-08587b50e6433da22 | - |
| AWS::EFS::MountTarget | CREATE_COMPLETE | ClamAVServerlessClamscanScanFileSystemEfsMountTargetIsolatedSubnet10E5FFF9B | fsmt-0aa087c6ab8c01bb0 | - |
| AWS::EFS::MountTarget | CREATE_COMPLETE | ClamAVServerlessClamscanScanFileSystemEfsMountTargetIsolatedSubnet2A6C59816 | fsmt-0301f405d09b96fda | - |
| AWS::EFS::AccessPoint | CREATE_COMPLETE | ClamAVServerlessClamscanScanFileSystemScanLambdaAPFB73BA30 | fsap-0a4de19238830b45f | - |
| AWS::Lambda::Permission | CREATE_COMPLETE | ClamAVDemoBucketAllowBucketNotificationsToClamAVMalwareScannerCDKDeployClamAVServerlessClamscan281235AB7E183A2B | ClamAV-Malware-Scanner-CDKDeploy-ClamAVDemoBucketAllowBucketNotificationsToClamAVMalwar-rqeMcwiOR7j4 | - |
| AWS::Lambda::Permission | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsUpdateRuleAllowEventRuleClamAVMalwareScannerCDKDeployClamAVServerlessClamscanDownloadDefs8DD3A7B0F8270516 | ClamAV-Malware-Scanner-CDKDeploy-ClamAVServerlessClamscanVirusDefsUpdateRuleAllowEventR-BOPDdV5JM3Y3 | - |
| AWS::Lambda::Function | CREATE_COMPLETE | BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691 | ClamAV-Malware-Scanner-CD-BucketNotificationsHandl-LZePnZK9FNdy | - |
| AWS::Lambda::Function | CREATE_COMPLETE | ClamAVServerlessClamscan581C3F8C | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscan-20PQFFATzHqG | - |
| AWS::Lambda::Function | CREATE_COMPLETE | ClamAVServerlessClamscanDownloadDefs6269DD98 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscan-RfFCsfHt3Iia | - |
| AWS::Lambda::Function | CREATE_COMPLETE | ClamAVServerlessClamscanInitDefs5B3294D6 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscan-bvb4y685I7U8 | - |
| AWS::Lambda::Function | CREATE_COMPLETE | CustomS3AutoDeleteObjectsCustomResourceProviderHandler9D90184F | ClamAV-Malware-Scanner-CD-CustomS3AutoDeleteObject-tIQcrKjv8Vxk | - |
| AWS::Lambda::Function | CREATE_COMPLETE | CustomVpcRestrictDefaultSGCustomResourceProviderHandlerDC833E5E | ClamAV-Malware-Scanner-CD-CustomVpcRestrictDefault-QfWseU9ECNXZ | - |
| AWS::Lambda::EventInvokeConfig | CREATE_COMPLETE | ClamAVServerlessClamscanEventInvokeConfig37660434 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscan-20PQFFATzHqG\|$LATEST | - |
| AWS::S3::Bucket | CREATE_COMPLETE | ClamAVDemoBucket59D88F14 | clamav-malware-scanner-cd-clamavdemobucket59d88f14-xu8ztkrvytrz | - |
| AWS::S3::Bucket | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsAccessLogsBucket43FF8F3A | clamav-malware-scanner-cd-clamavserverlessclamscan-bvocqwbwcyzi | - |
| AWS::S3::Bucket | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsBucketACCE1AC7 | clamav-malware-scanner-cd-clamavserverlessclamscan-x2irozm5tfag | - |
| AWS::S3::BucketPolicy | CREATE_COMPLETE | ClamAVDemoBucketPolicy9B610683 | clamav-malware-scanner-cd-clamavdemobucket59d88f14-xu8ztkrvytrz | - |
| AWS::S3::BucketPolicy | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsBucketPolicyBB111C40 | clamav-malware-scanner-cd-clamavserverlessclamscan-x2irozm5tfag | - |
| AWS::S3::BucketPolicy | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsAccessLogsBucketPolicy51052F04 | clamav-malware-scanner-cd-clamavserverlessclamscan-bvocqwbwcyzi | - |
| Custom::S3AutoDeleteObjects | CREATE_COMPLETE | ClamAVDemoBucketAutoDeleteObjectsCustomResource88C85138 | 5fe857dc-5453-48e5-a561-6ff96a47d030 | - |
| Custom::S3BucketNotifications | CREATE_COMPLETE | ClamAVDemoBucketNotifications7E50D8E6 | ClamAVDemoBucketNotifications7E50D8E6 | - |
| Custom::S3AutoDeleteObjects | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsBucketAutoDeleteObjectsCustomResourceD434D431 | 72709b69-a856-4276-9034-6f0c8d6f3424 | - |
| AWS::Events::Rule | CREATE_COMPLETE | ClamAVServerlessClamscanCleanRuleC8957CB4 | ClamAVMalwareScannerCDKDeployClamAVServerlessClamscanScanResultBus46A35C35\|ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanC-wTFWggGPOJ9t | - |
| AWS::Events::Rule | CREATE_COMPLETE | ClamAVServerlessClamscanInfectedRule4F438D58 | ClamAVMalwareScannerCDKDeployClamAVServerlessClamscanScanResultBus46A35C35\|ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanI-fhZQ1NoJNdz5 | - |
| AWS::Events::Rule | CREATE_COMPLETE | ClamAVServerlessClamscanVirusDefsUpdateRuleCBDCB7B3 | ClamAV-Malware-Scanner-CD-ClamAVServerlessClamscanV-EN3H0hAFKwZt | - |
| AWS::Events::EventBus | CREATE_COMPLETE | ClamAVServerlessClamscanScanResultBus7A815431 | ClamAVMalwareScannerCDKDeployClamAVServerlessClamscanScanResultBus46A35C35 | - |
| AWS::SQS::Queue | CREATE_COMPLETE | ClamAVServerlessClamscanScanErrorDeadLetterQueueD4D0248C | https://sqs.us-east-2.amazonaws.com/591580567012/ClamAV-Malware-Scanner-CDKDeploy-ClamAVServerlessClamscanScanErrorD-qdTwDIwnBdbL | - |
| AWS::SQS::QueuePolicy | CREATE_COMPLETE | ClamAVServerlessClamscanScanErrorDeadLetterQueuePolicy8815F80B | ClamAV-Malware-Scanner-CDKDeploy-ClamAVServerlessClamscanScanErrorD-T5DdsoXOKw8V | - |
| AWS::SQS::Queue | CREATE_COMPLETE | ClamAVServerlessClamscanScanErrorQueueD6FA800B | https://sqs.us-east-2.amazonaws.com/591580567012/ClamAV-Malware-Scanner-CDKDeploy-ClamAVServerlessClamscanScanErrorQ-rzZJYXqXDngj | - |
| AWS::SQS::QueuePolicy | CREATE_COMPLETE | ClamAVServerlessClamscanScanErrorQueuePolicyD232BA46 | ClamAV-Malware-Scanner-CDKDeploy-ClamAVServerlessClamscanScanErrorQ-dBtdq0bZAhLs | - |
| --- | --- | --- | --- | --- |


<HR/>
<HR/>
<HR/>
<HR/>

# Appendix: Justification for contents of IAM-Role.

Re: [IAM-Role JSON file](./etc/cdk-deploy-iam-role-CFT.json)

Here's the errors that lead to the Access-Statements in it.

```
CdkStack: deploying... [1/1]
CdkStack: creating CloudFormation changeset...

 ❌  CdkStack failed: AccessDenied: User: arn:aws:sts::591580567012:assumed-role/cdk-hnb659fds-deploy-role-591580567012-us-east-2/aws-cdk-test is not authorized to perform: iam:PassRole on resource: arn:aws:iam::591580567012:role/ClamAV-Malware-Scanner_CDK-Deploy because no identity-based policy allows the iam:PassRole action

9:12:03 PM | CREATE_FAILED        | AWS::EFS::FileSystem                  | ClamAVServerlessCl...FileSystem52F92282
Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: elasticfilesystem:TagRe
source on the specified resource (Service: Efs, Status Code: 403, Request ID: cb47cb8e-2149-401d-99bd-ea4e694707b0)" (RequestToken: 0390a822-e5cd-3e58-4c1f-a39a090c9b16, HandlerErrorCode
: GeneralServiceException)

9:12:03 PM | CREATE_FAILED        | AWS::EC2::VPC                         | ClamAVServerlessClamscanScanVPC9CE28EB8
Resource handler returned message: "You are not authorized to perform this operation. User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is
not authorized to perform: ec2:CreateVpc on resource: arn:aws:ec2:us-east-2:591580567012:vpc/* because no identity-based policy allows the ec2:CreateVpc action. Encoded authorization fai
lure message: wFGMenKibAKFNNJqbrUuN8_S8t3seJFfvugO0OcMubQuCC7P45yb239m6fuzUJqx2fLMMy57AanYqenZXCIcFTXC0tQ_wqgz93Ssa_wf6e5CkKcgMQqePCmNZ1xGqh0tUk9Ft6d43sbr_BfranqLzRXhej45Ej9p5GbYTzPes2gY
2tRXq6lEAUvMc48w9SDDQ7WhkoPERQK4LxvF79FggRJX8vG4VO64jOlK8zKmgMX4Kjq-4BXwSfEUMmFy3p6PuJktdoF74f8jTwLbGoff76D26fX3F5Dre8TKBVGa-gIW6AgsA3ej2sQYyMuLoxto10LyNXjIl8x0UdH_vSO3Nc8zTWhx1p5E7U-4G4
C_dOIzKpsHBnWQw3LRk2FqQlxBrLNMZIMbR66poRCWlJBWiJ5ErwdMT30hQ9rofSenhADPwFGloBKVMgW24mgLxIgcJn_eug2g8yy4GahtLaiUyHnnPbDXqRFAKyYsTzN0aVThes2UHbJyl28L9iBaHe8eKVaVWvJm8fXXFBH236T-cM4J2OP7FyVP
nPTgKOPckFGFhMU (Service: Ec2, Status Code: 403, Request ID: dd966fbc-1fce-4c61-87f0-3879902703e9)" (RequestToken: ea3c6b29-139b-051d-1977-26a4a9516746, HandlerErrorCode: AccessDenied)

9:12:03 PM | CREATE_FAILED        | AWS::Events::EventBus                 | ClamAVServerlessCl...nResultBus7A815431
Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: events:DescribeEventBus
on resource: arn:aws:events:us-east-2:591580567012:event-bus/CdkStackClamAVServerlessClamscanScanResultBus04ACEBC2 because no identity-based policy allows the events:DescribeEventBus act
ion (Service: EventBridge, Status Code: 400, Request ID: 9aed4a75-d39c-4005-82e2-d7442f8e4ab5)" (RequestToken: 2cd59e74-61c7-d110-6a1a-ad4baf15c940, HandlerErrorCode: AccessDenied)

9:12:03 PM | CREATE_FAILED        | AWS::SQS::Queue                       | ClamAVServerlessCl...etterQueueD4D0248C
Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: sqs:getqueueattributes
on resource: arn:aws:sqs:us-east-2:591580567012:CdkStack-ClamAVServerlessClamscanScanErrorDeadLetterQueueD4D0248C-j3OMqUCDCIM1 because no identity-based policy allows the sqs:getqueueatt
ributes action (Service: Sqs, Status Code: 403, Request ID: 50ef62a7-123f-5ca4-a548-3c4b209c3deb)" (RequestToken: 4795fb9a-3283-70dd-3fd9-b970e1e0589a, HandlerErrorCode: AccessDenied)

9:12:07 PM | DELETE_FAILED        | AWS::Events::EventBus                 | ClamAVServerlessCl...nResultBus7A815431
Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: events:DescribeEventBus
on resource: arn:aws:events:us-east-2:591580567012:event-bus/CdkStackClamAVServerlessClamscanScanResultBus04ACEBC2 because no identity-based policy allows the events:DescribeEventBus act
ion (Service: EventBridge, Status Code: 400, Request ID: 5daf8127-7d28-4aca-ba32-5724c612fe1a)" (RequestToken: 02ad20c2-c486-be94-ee59-08e7b09581a2, HandlerErrorCode: InvalidRequest)


 ❌  CdkStack failed: Error: The stack named CdkStack failed creation, it may need to be manually deleted from the AWS console: ROLLBACK_FAILED (The following resource(s) failed to delete: [ClamAVServerlessClamscanScanResultBus7A815431]. ): Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: elasticfilesystem:TagResource on the specified resource (Service: Efs, Status Code: 403, Request ID: cb47cb8e-2149-401d-99bd-ea4e694707b0)" (RequestToken: 0390a822-e5cd-3e58-4c1f-a39a090c9b16, HandlerErrorCode: GeneralServiceException), Resource handler returned message: "You are not authorized to perform this operation. User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: ec2:CreateVpc on resource: arn:aws:ec2:us-east-2:591580567012:vpc/* because no identity-based policy allows the ec2:CreateVpc action. Encoded authorization failure message: wFGMenKibAKFNNJqbrUuN8_S8t3seJFfvugO0OcMubQuCC7P45yb239m6fuzUJqx2fLMMy57AanYqenZXCIcFTXC0tQ_wqgz93Ssa_wf6e5CkKcgMQqePCmNZ1xGqh0tUk9Ft6d43sbr_BfranqLzRXhej45Ej9p5GbYTzPes2gY2tRXq6lEAUvMc48w9SDDQ7WhkoPERQK4LxvF79FggRJX8vG4VO64jOlK8zKmgMX4Kjq-4BXwSfEUMmFy3p6PuJktdoF74f8jTwLbGoff76D26fX3F5Dre8TKBVGa-gIW6AgsA3ej2sQYyMuLoxto10LyNXjIl8x0UdH_vSO3Nc8zTWhx1p5E7U-4G4C_dOIzKpsHBnWQw3LRk2FqQlxBrLNMZIMbR66poRCWlJBWiJ5ErwdMT30hQ9rofSenhADPwFGloBKVMgW24mgLxIgcJn_eug2g8yy4GahtLaiUyHnnPbDXqRFAKyYsTzN0aVThes2UHbJyl28L9iBaHe8eKVaVWvJm8fXXFBH236T-cM4J2OP7FyVPnPTgKOPckFGFhMU (Service: Ec2, Status Code: 403, Request ID: dd966fbc-1fce-4c61-87f0-3879902703e9)" (RequestToken: ea3c6b29-139b-051d-1977-26a4a9516746, HandlerErrorCode: AccessDenied), Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: events:DescribeEventBus on resource: arn:aws:events:us-east-2:591580567012:event-bus/CdkStackClamAVServerlessClamscanScanResultBus04ACEBC2 because no identity-based policy allows the events:DescribeEventBus action (Service: EventBridge, Status Code: 400, Request ID: 9aed4a75-d39c-4005-82e2-d7442f8e4ab5)" (RequestToken: 2cd59e74-61c7-d110-6a1a-ad4baf15c940, HandlerErrorCode: AccessDenied), Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: sqs:getqueueattributes on resource: arn:aws:sqs:us-east-2:591580567012:CdkStack-ClamAVServerlessClamscanScanErrorDeadLetterQueueD4D0248C-j3OMqUCDCIM1 because no identity-based policy allows the sqs:getqueueattributes action (Service: Sqs, Status Code: 403, Request ID: 50ef62a7-123f-5ca4-a548-3c4b209c3deb)" (RequestToken: 4795fb9a-3283-70dd-3fd9-b970e1e0589a, HandlerErrorCode: AccessDenied), Resource handler returned message: "User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner_CDK-Deploy/AWSCloudFormation is not authorized to perform: events:DescribeEventBus on resource: arn:aws:events:us-east-2:591580567012:event-bus/CdkStackClamAVServerlessClamscanScanResultBus04ACEBC2 because no identity-based policy allows the events:DescribeEventBus action (Service: EventBridge, Status Code: 400, Request ID: 5daf8127-7d28-4aca-ba32-5724c612fe1a)" (RequestToken: 02ad20c2-c486-be94-ee59-08e7b09581a2, HandlerErrorCode: InvalidRequest)
    at FullCloudFormationDeployment.monitorDeployment (/opt/homebrew/Cellar/aws-cdk/2.146.0/libexec/lib/node_modules/aws-cdk/lib/index.js:451:10568)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Object.deployStack2 [as deployStack] (/opt/homebrew/Cellar/aws-cdk/2.146.0/libexec/lib/node_modules/aws-cdk/lib/index.js:454:199716)
    at async /opt/homebrew/Cellar/aws-cdk/2.146.0/libexec/lib/node_modules/aws-cdk/lib/index.js:454:181438

10:21:12 PM | DELETE_FAILED        | AWS::EC2::VPC                         | ClamAVServerlessClamscanScanVPC9CE28EB8
Resource handler returned message: "You are not authorized to perform this operation. User: arn:aws:sts::591580567012:assumed-role/ClamAV-Malware-Scanner-CDKDeploy/AWSCloudFormation is n
ot authorized to perform: ec2:DescribeVpcs because no identity-based policy allows the ec2:DescribeVpcs action (Service: Ec2, Status Code: 403, Request ID: 66c6afc7-7105-4976-971a-78bda0
0e41b4)" (RequestToken: d20b094d-8048-a915-f546-d927db0e7783, HandlerErrorCode: AccessDenied)

```

# EoF
